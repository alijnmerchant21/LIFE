<!-- This document is created by Ali in Harvard for "LIFE" This is similar to Uber Eats for pharmacy delivery. -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" />

  <link rel="stylesheet" href="https://drvic10k.github.io/bootstrap-sortable/Contents/bootstrap-sortable.css" />

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.19.1/moment.js"></script>

  <script src="https://drvic10k.github.io/bootstrap-sortable/Scripts/bootstrap-sortable.js"></script>

  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">


  <!--   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://drvic10k.github.io/bootstrap-sortable/Contents/bootstrap-sortable.css" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.19.1/moment.js"></script>
    <script src="https://drvic10k.github.io/bootstrap-sortable/Scripts/bootstrap-sortable.js"></script>
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet"> -->


    <!-- <link rel="stylesheet" href="http://code.jquery.com/ui/1.9.1/themes/base/jquery-ui.css"> -->
    <!-- <link rel="stylesheet" href="https://cdn.datatables.net/1.10.16/css/dataTables.bootstrap.min.css"> -->

    <link rel="stylesheet" type="text/css" href="main.css">

    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->
    <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> -->
    <!-- <script src="https://code.jquery.com/jquery-3.3.1.js"></script> -->
    <!-- <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script> -->
    <!-- <script src="https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap.min.js"></script> -->

    <script src="./node_modules/web3/dist/web3.min.js"></script>





    


    <title>LIFE</title>

</head>

<body>
    <div class="container">

        

    <div class="container">
        <div class="header">
            
            <center> <h1><img src='life.png' alt="logo"/></h1> </center>
          
        </div>
          <div class="container-fluid card">
            <h3>All Transactions</h3><br>
            <h4 id="transactionCount"></h4>

            <table class="table table-hover data-sortable bootstrap-sortable sortable" data-toggle="table" data-sort-order="desc" id="table">
              <thead>
                <tr>
                  <th data-sortable="true">Drug ID</th>
                  <th data-sortable="true">Drug Name</th>
                  <th data-sortable="true">Quantity</th>
                  <th data-sortable="true">User Type</th>
                  <th data-sortable="true">Buyer ID</th>
                  <th data-sortable="true">Buyer Name</th>
                  <th data-sortable="true">Seller ID</th>
                  <th data-sortable="true">Seller Name</th>
                  <th data-sortable="true">Block Number</th>
                  <th data-sortable="true">Block Hash</th>
                  <th></th>

                </tr>
              </thead >
               <tbody id = "display_table">
            
              </tbody>
            </table>
          </div>

          <!-- Modal -->
<!--        <div class="modal fade" id="showMoreModal" role="dialog">
          <div class="modal-dialog modal-lg">
           -->
            <!-- Modal content-->
            <!-- <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title" id="modal-title">Drug Details</h4>
                

              </div>
              <div class="modal-body" id="modal-body">
                <div id="qr">
                  <img id='barcode' src="" alt="" title="HELLO" width="25%" height="25%" />
                </div>
                <table class="table table-hover" data-toggle="table" id="modal-table"> -->
                <!-- <thead>
                  <tr>
                    <th></th>
                    <th></th>
                  </tr>
                </thead > -->
                 <!-- <tbody> -->
                 <!--  <tr>
                    <td>Transaction Index: </td>
                    <td id="modal-transaction-index"></td>
                  </tr> -->

                  <!-- <tr>
                    <td>Drug ID: </td>
                    <td id="modal-drug-id"></td>
                  </tr>
                  <tr>
                    <td>Drug Name: </td>
                    <td id="modal-drug-name"></td>
                  </tr>
                  <tr>
                    <td>Quantity: </td>
                    <td id="modal-quantity"></td>
                  </tr>
                  <tr>
                    <td>User Type: </td>
                    <td id="modal-location"></td>
                  </tr>
                  <tr>
                    <td>Transaction Added By: </td>
                    <td id="modal-transaction-added-by"></td>
                  </tr>
                  <tr>
                    <td>Buyer ID: </td>
                    <td id="modal-buyer-id"></td>
                  </tr>
                  <tr>
                    <td>Buyer Name: </td>
                    <td id="modal-buyer-name"></td>
                  </tr>
                  <tr>
                    <td>Seller ID: </td>
                    <td id="modal-seller-id"></td>
                  </tr>
                  <tr>
                    <td>Seller Name: </td>
                    <td id="modal-seller-name"></td>
                  </tr>
                  <tr>
                    <td>Block Number: </td>
                    <td id="modal-block-hash"></td>
                  </tr> -->
                  <!-- <tr>
                    <td>Block Hash Now: </td>
                    <td id="modal-block-number"></td>
                  </tr> -->
                  <!-- <tr>
                    <td>Block Hash: </td>
                    <td id="modal-transaction-hash"></td>
                  </tr>
 -->
<!--                 </tbody>
              </table>

              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              </div>
            </div>
            
          </div>
        </div>
 -->
        <div class="container-fluid card">
          <h3 >Add Transaction</h3><br><br>
          <form class="form-horizontal" action="javascript:void(0);">
            <div class="form-group">
              <label class="control-label col-sm-2">Drug ID</label>
              <div class="col-sm-10">
                <input type="number" class="form-control" id="drugId" placeholder="Enter Drug ID">
              </div>
            </div>
            <div class="form-group">
              <label class="control-label col-sm-2">Drug Name</label>
              <div class="col-sm-10">          
                <input type="text" class="form-control" id="drugName" placeholder="Enter Drug Name: "">
              </div>
            </div>

            <div class="form-group">
              <label class="control-label col-sm-2">Buyer ID</label>
              <div class="col-sm-10">          
                <input type="number" class="form-control" id="buyerId" placeholder="Enter Buyer ID"">
              </div>
            </div>

            <div class="form-group">
              <label class="control-label col-sm-2">Buyer Name</label>
              <div class="col-sm-10">          
                <input type="text" class="form-control" id="buyerName" placeholder="Enter Buyer Name"">
              </div>
            </div>

            <div class="form-group">
              <label class="control-label col-sm-2">Seller ID</label>
              <div class="col-sm-10">          
                <input type="number" class="form-control" id="sellerId" placeholder="Enter Seller ID"">
              </div>
            </div>
            
            <div class="form-group">
              <label class="control-label col-sm-2">Seller Name</label>
              <div class="col-sm-10">          
                <input type="text" class="form-control" id="sellerName" placeholder="Enter Seller Name"">
              </div>
            </div>

            <div class="form-group">
              <label class="control-label col-sm-2">User Type (Seller)</label>
              <div class="col-sm-10"> 
                <select class="form-control" id="userType">
                  <option value="1">Manufacturer</option>
                  <option value="2">Wholesaler</option>
                  <option value="3">Chemist</option>
                <!-- <option value="4">Patients</option> -->
                  <option value="4">Regulatory Authorities</option>
                </select>
              </div>
            </div>

            <div class="form-group">
              <label class="control-label col-sm-2">Quantity</label>
              <div class="col-sm-10">          
                <input type="number" class="form-control" id="quantity" placeholder="Enter Quantity">
              </div>
            </div>  

            <div class="form-group">
              <label class="control-label col-sm-2">Location</label>
              <div class="col-sm-10">          
                <input type="text" class="form-control" id="location" placeholder="Enter Seller Name"">
              </div>
            </div>  


            <div class="form-group">        
              <div class="col-sm-offset-2 col-sm-10">
                <button type="submit" class="btn btn-default" id="button">Add Transaction</button>
              </div>
            </div>
          </form>
        </div>



<!--         <h2 id="transaction"></h2>
        <h2 id="transaction_results"></h2>
 -->
        <div class="container-fluid card">
          <h3 >Search by Drug ID</h3><br><br>
          <form class="form-horizontal" action="javascript:void(0);">
           
            <div class="form-group">
              <label class="control-label col-sm-2">Search transactions by Drug ID</label>
              <div class="col-sm-10">          
                <input type="text" class="form-control" id="drug_search_id" placeholder="Enter Drug ID">
              </div>
            </div>  

            <div class="form-group">        
              <div class="col-sm-offset-2 col-sm-10">
                <button type="submit" class="btn btn-default" id="drug_search">Search</button>
              </div>
            </div>
          </form>
<!--         </div>
    <div class="container">
 -->          
          <h3 class='drug_search_table_box'>Drug ID specific Transactions</h3>
            <table class="table table-hover drug_search_table_box card" id="drug_id_search_table">
              <thead>
                <tr>
                  <th>Drug ID</th>
                  <th>Drug Name</th>
                  <th>Quantity</th>
                  <th>User Type</th>
                  <th>Buyer ID</th>
                  <th>Buyer Name</th>
                  <th>Seller ID</th>
                  <th>Seller Name</th>
                  <th>Block Number</th>
                  <th>Block Hash</th>
                  <th></th>

                </tr>
              </thead >
               <tbody id = "drug_search_results_box">
            
              </tbody>
            </table>
        </div>

        <div class="container card">
          <h3 >Search by Seller ID</h3><br><br>
          <form class="form-horizontal" action="javascript:void(0);">
           
            <div class="form-group">
              <label class="control-label col-sm-2">Search transactions by Seller ID</label>
              <div class="col-sm-10">          
                <input type="text" class="form-control" id="drug_search_id" placeholder="Enter Drug ID">
              </div>
            </div>  

            <div class="form-group">        
              <div class="col-sm-offset-2 col-sm-10">
                <button type="submit" class="btn btn-default" id="drug_search">Search</button>
              </div>
            </div>
          </form>
          <h3 class='drug_search_table_box'>Drug ID specific Transactions</h3>
            <table class="table table-hover drug_search_table_box card">
              <thead>
                <tr>
                  <th>Drug ID</th>
                  <th>Drug Name</th>
                  <th>Quantity</th>
                  <th>Location</th>
                  <th>Buyer ID</th>
                  <th>Buyer Name</th>
                  <th>Seller ID</th>
                  <th>Seller Name</th>
                  <th></th>

                </tr>
              </thead >
               <tbody id = "drug_search_results_box">
            
              </tbody>
            </table>
        </div> 

        <div class="container card">
          <h3 >Search by Seller ID</h3><br><br>
          <form class="form-horizontal" action="javascript:void(0);">
           
            <div class="form-group">
              <label class="control-label col-sm-2">Search transactions by Seller ID</label>
              <div class="col-sm-10">          
                <input type="text" class="form-control" id="search_id" placeholder="Enter Transaction ID">
              </div>
            </div>  

            <div class="form-group">        
              <div class="col-sm-offset-2 col-sm-10">
                <button type="submit" class="btn btn-default" id="search">Search</button>
              </div>
            </div>
          </form>
          <h2 class="trans_search_table_box">Seller ID Search</h2>
            <table class="table table-hover trans_search_table_box card">
              <thead>
                <tr>
                  <th>Drug ID</th>
                  <th>Drug Name</th>
                  <th>Quantity</th>
                  <th>User Type</th>
                  <th>Buyer ID</th>
                  <th>Buyer Name</th>
                  <th>Seller ID</th>
                  <th>Seller Name</th>
                  <th>Block Number</th>
                  <th>Block Hash</th>
                  <th></th>
                </tr>
              </thead >
               <tbody id = "search_results_box">
            
              </tbody>
            </table>
        </div>

    </div>

     

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>

    <script>

        if (typeof web3 !== 'undefined') {
            web3 = new Web3(web3.currentProvider);
        } else {
            // set the provider you want from Web3.providers
            web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));
        }

        web3.eth.defaultAccount = web3.eth.accounts[0];


        var SeaPharmaContract = web3.eth.contract(
[
  {
    "constant": false,
    "inputs": [],
    "name": "getTransactionId",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "constant": false,
    "inputs": [
      {
        "name": "_drugId",
        "type": "uint256"
      },
      {
        "name": "_drugName",
        "type": "string"
      },
      {
        "name": "_buyerId",
        "type": "uint256"
      },
      {
        "name": "_buyerName",
        "type": "string"
      },
      {
        "name": "_sellerId",
        "type": "uint256"
      },
      {
        "name": "_sellerName",
        "type": "string"
      },
      {
        "name": "_userType",
        "type": "uint256"
      },
      {
        "name": "_quantity",
        "type": "uint256"
      }
    ],
    "name": "setDrugTransaction",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "nonpayable",
    "type": "function"
  },
  {
    "anonymous": false,
    "inputs": [
      {
        "indexed": false,
        "name": "id",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "drugId",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "drugName",
        "type": "string"
      },
      {
        "indexed": false,
        "name": "buyerId",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "buyerName",
        "type": "string"
      },
      {
        "indexed": false,
        "name": "sellerId",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "sellerName",
        "type": "string"
      },
      {
        "indexed": false,
        "name": "userType",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "quantity",
        "type": "uint256"
      },
      {
        "indexed": false,
        "name": "transactionAddedBy",
        "type": "address"
      }
    ],
    "name": "transactionInfo",
    "type": "event"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "blockHashNow",
    "outputs": [
      {
        "name": "",
        "type": "bytes32"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "blockHashPrevious",
    "outputs": [
      {
        "name": "",
        "type": "bytes32"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "blockNumber",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "countTransactions",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "getAllTransactions",
    "outputs": [
      {
        "name": "",
        "type": "uint256[]"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "_id",
        "type": "uint256"
      }
    ],
    "name": "getBuyerSellerDetails",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "string"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "string"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "bytes32"
      },
      {
        "name": "",
        "type": "bytes32"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "_id",
        "type": "uint256"
      }
    ],
    "name": "getTransactionDetails",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "string"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "uint256"
      },
      {
        "name": "",
        "type": "address"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [],
    "name": "transactionId",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  },
  {
    "constant": true,
    "inputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "name": "transactionsArr",
    "outputs": [
      {
        "name": "",
        "type": "uint256"
      }
    ],
    "payable": false,
    "stateMutability": "view",
    "type": "function"
  }
]
);

    var SeaPharma = SeaPharmaContract.at('0x035087b45c1e407beca0329e96c7c4aa49c90e89');


// ------------------------------add transaction method -----------

        var t = $("#button").click(function() {

          SeaPharma.setDrugTransaction($("#drugId").val(), $("#drugName").val(), $("#buyerId").val(), $("#buyerName").val(), $("#sellerId").val(), $("#sellerName").val(), $("#userType").val(), $("#quantity").val(), (err, res) => {

                if(err){
                    $("#transaction").html(err + '!!');
                    console.log(err);
                }
                console.log(res);
                if(res) {
                  console.log('set trans');
                    console.log(res); 
                }

            });

        });

// ----------------------------get all transactions -----------------------------------


        var allTransactionsList = [];


        SeaPharma.getAllTransactions((err, alltrans_result) => { // open *

          atr = alltrans_result;
      

            if(atr){
                var i;
                var table_display_str = '';
                var bId, bName, sId, sName, blockNumber, blockHashNow, blockHashPrev;
                for(i=0; i<atr.length; i++){
                    var t = atr[i].c;
                    var tmpList=[];
                    SeaPharma.getBuyerSellerDetails(t, (err, bs_res) => {
                      // console.log('bs_res');
                      // console.log(bs_res);
                        bId = bs_res[0].c;
                        bName =bs_res[1];
                        sId = bs_res[2].c;
                        sName = bs_res[3];
                        blockNumber = bs_res[4].c;
                        blockHashNow = bs_res[5];
                        blockHashPrev = bs_res[6];
                        console.log(blockNumber, blockHashNow, blockHashPrev);


                        });

                        SeaPharma.getTransactionDetails(t, (err, search_res) => {
                            if(search_res){
                              


                                tmpList = [search_res[0].c, search_res[1], search_res[2].c, search_res[3].c, search_res[4], bId, bName, sId, sName, blockNumber, blockHashNow, blockHashPrev, i];
                                console.log(blockNumber, blockHashNow, blockHashPrev);
                                console.log(tmpList);
                                allTransactionsList.push(tmpList);


                                user_type_value = '';

                                if(tmpList[3]==1){
                                  user_type_value = "Manufacturer";
                                }
                                if(tmpList[3]==2){
                                  user_type_value = "Wholesaler";
                                }
                                if(tmpList[3]==3){
                                  user_type_value = "Chemist";
                                }
                                if(tmpList[3]==4){
                                  user_type_value = "Retail";
                                }
                                qr_str = tmpList[0] + ' ' + tmpList[1];

                                table_display_str = table_display_str + "<tr><td>" + tmpList[0]+ "</td><td>"+ tmpList[1] +"</td><td>"+ tmpList[2] +"</td><td>"+ user_type_value +"</td><td>"+ tmpList[5] +"</td><td>"+ tmpList[6] +"</td><td>"+ tmpList[7] +"</td><td>"+ tmpList[8] +"</td><td>" + tmpList[9] +"</td><td>" + tmpList[11] +"</td><td>" + "<img src = 'https://api.qrserver.com/v1/create-qr-code/?data="+qr_str+"&amp;size=50x50'>" + "</td></tr>";
                                $("#display_table").html(table_display_str);

                                

                                 $("#modal-transaction-index").html(transactionIndex);
                                 $("#modal-drug-id").html(tmpList[0]);
                                 $("#modal-drug-name").html(tmpList[1]);
                                 $("#modal-quantity").html(tmpList[2]);
                                 $("#modal-location").html(tmpList[3]);
                                 $("#modal-transaction-added-by").html(tmpList[4]);
                                 $("#modal-buyer-id").html(tmpList[5]);
                                 $("#modal-buyer-name").html(tmpList[6]);
                                 $("#modal-seller-id").html(tmpList[7]);
                                 $("#modal-seller-name").html(tmpList[8]);
                                 $("#modal-block-hash").html(blockNumber);
                                 $("#modal-block-number").html(blockHashNow);
                                 $("#modal-transaction-hash").html(blockHashPrev);

                            }

                        });
                }
            }        

         }); // closes *
// ----------------------------drug search method------------------

        var t = $("#drug_search").click(function() {
                        $(".drug_search_table_box").show();

         var drugDisplayList = [];

            var i;
            for(i=0; i<allTransactionsList.length; i++)
            { 
              console.log(allTransactionsList[i][0]);

                var _dID = $("#drug_search_id").val();

                if(_dID == allTransactionsList[i][0]){
                    drugDisplayList.push(allTransactionsList[i]);
                }


            }

        var drug_table_disp_str = '';

            for(i=0; i< drugDisplayList.length; i++)
            {            

                          user_type_value = '';

                              if(drugDisplayList[i][3]==1){
                                user_type_value = "Manufacturer";
                              }
                              if(drugDisplayList[i][3]==2){
                                user_type_value = "Wholesaler";
                              }
                              if(drugDisplayList[i][3]==3){
                                user_type_value = "Chemist";
                              }
                              if(drugDisplayList[i][3]==4){
                                user_type_value = "Retail";
                              }
                qr_str = drugDisplayList[i][0] + ' ' + drugDisplayList[i][1];

                drug_table_disp_str = drug_table_disp_str + "<tr><td>" + drugDisplayList[i][0]+ "</td><td>"+ drugDisplayList[i][1] +"</td><td>"+ drugDisplayList[i][2] +"</td><td>"+ user_type_value +"</td><td>"+ drugDisplayList[i][5] +"</td><td>"+ drugDisplayList[i][6] +"</td><td>"+ drugDisplayList[i][7] +"</td><td>"+ drugDisplayList[i][8] +"</td><td>" + drugDisplayList[i][9] +"</td><td>" + drugDisplayList[i][11] +"</td><td>" +  "<img src = 'https://api.qrserver.com/v1/create-qr-code/?data="+qr_str+"&amp;size=50x50'>" +  "</td></tr>";

                  $("#drug_search_results_box").html(drug_table_disp_str);


                   generateBarCode(drugDisplayList[i][0] + " " + drugDisplayList[i][1]);

                   $("#modal-drug-id").html(drugDisplayList[i][0]);
                   $("#modal-drug-name").html(drugDisplayList[i][1]);
                   $("#modal-quantity").html(drugDisplayList[i][2]);
                   $("#modal-location").html(user_type_value);
                   $("#modal-transaction-added-by").html(drugDisplayList[i][4]);
                   $("#modal-buyer-id").html(drugDisplayList[i][5]);
                   $("#modal-buyer-name").html(drugDisplayList[i][6]);
                   $("#modal-seller-id").html(drugDisplayList[i][7]);
                   $("#modal-seller-name").html(drugDisplayList[i][8]);
                   $("#modal-block-hash").html(drugDisplayList[i][9]);
                   $("#modal-block-number").html(drugDisplayList[i][10]);
                   $("#modal-transaction-hash").html(drugDisplayList[i][11]);

            }
            
        });

// ------------------------------------------seller id search --------------

        var s = $("#search").click(function(){//button name search
                        $(".trans_search_table_box").show();

            var seller_search_list = [];


            var i;
            for(i=0; i<allTransactionsList.length; i++)
            { 

                var _sID = $("#search_id").val();

                if(_sID == allTransactionsList[i][7]){
                  console.log(_sID, allTransactionsList[i][7]);
                    seller_search_list.push(allTransactionsList[i]);
                }


            }      

            var i;
            var transaction_search_str = '';    

            for(i=0; i<seller_search_list.length; i++)
            {

                        user_type_value = '';

                              if(seller_search_list[i][3]==1){
                                user_type_value = "Manufacturer";
                              }
                              if(seller_search_list[i][3]==2){
                                user_type_value = "Wholesaler";
                              }
                              if(seller_search_list[i][3]==3){
                                user_type_value = "Chemist";
                              }
                              if(seller_search_list[i][3]==4){
                                user_type_value = "Retail";
                              }

              // console.log('length', seller_search_list.length);
                    qr_str = seller_search_list[i][0] + ' ' + seller_search_list[i][1];

                    transaction_search_str = transaction_search_str + "<tr><td>" + seller_search_list[i][0]+ "</td><td>"+ seller_search_list[i][1] +"</td><td>"+ seller_search_list[i][2] +"</td><td>"+ user_type_value + "</td><td>"+ seller_search_list[i][5] +"</td><td>"+ seller_search_list[i][6] + "</td><td>" + seller_search_list[i][7] +"</td><td>"+ seller_search_list[i][8] +"</td><td>" + + seller_search_list[i][9] +"</td><td>"+ seller_search_list[i][11] +"</td><td>" + "<img src = 'https://api.qrserver.com/v1/create-qr-code/?data="+qr_str+"&amp;size=50x50'>" +  "</td></tr>";

                
                $("#search_results_box").html(transaction_search_str);

                 generateBarCode(seller_search_list[i][0] + " " + seller_search_list[i][1]);
                 $("#modal-drug-id").html(seller_search_list[i][0]);
                 $("#modal-drug-name").html(seller_search_list[i][1]);
                   $("#modal-quantity").html(seller_search_list[i][2]);
                   $("#modal-location").html(user_type_value);
                   $("#modal-transaction-added-by").html(seller_search_list[i][4]);
                   $("#modal-buyer-id").html(seller_search_list[i][5]);
                   $("#modal-buyer-name").html(seller_search_list[i][6]);
                   $("#modal-seller-id").html(seller_search_list[i][7]);
                   $("#modal-seller-name").html(seller_search_list[i][8]);
                   $("#modal-block-hash").html(seller_search_list[i][9]);
                   $("#modal-block-number").html(seller_search_list[i][10]);
                   $("#modal-transaction-hash").html(seller_search_list[i][11]);
            }

        });


// ------------------------------- function to generate barcode -----------------------------------

 $(document).ready(function() {
      $('#table').DataTable();
     $('#table tfoot th').each( function (i) {
         var title = $('#table thead th').eq( $(this).index() ).text();
         $(this).html( '<input type="text" placeholder="Search '+title+'" data-index="'+i+'" />' );
     } );
  
     // DataTable
     var table = $('#table').DataTable( {
         scrollY:        "300px",
         scrollX:        true,
         scrollCollapse: true,
         paging:         false,
         fixedColumns:   true
     } );
 
      Filter event handler
     $( table.table().container() ).on( 'keyup', 'tfoot input', function () {
         table
             .column( $(this).data('index') )
             .search( this.value )
             .draw();
     } );


 } );

    </script>

</body>
</html>

